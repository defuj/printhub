class PrintHub{constructor({paperSize:_0x4b7f4e="58mm",printerType:_0x5c6d7e="bluetooth"}={}){this._0x6e7f8g=new TextEncoder(),this._0x7g8h9i=new Uint8Array([27,97,1]),this._0x8i9j0k=new Uint8Array([27,97,2]),this._0x9j0k1l=new Uint8Array([27,97,0]),this._0x0k1l2m=new Uint8Array([27,69,1]),this._0x1l2m3n=new Uint8Array([27,69,0]),this._0x2m3n4o=new Uint8Array([27,45,1]),this._0x3n4o5p=new Uint8Array([27,45,0]),this._0x4o5p6q=new Uint8Array([29,33,17]),this._0x5p6q7r=new Uint8Array([29,33,0]),this._0x6q7r8s=null,this.printerType=_0x5c6d7e;if(_0x5c6d7e!=="bluetooth"&&_0x5c6d7e!=="usb")throw new Error('Invalid printer type. Only "bluetooth" and "usb" are supported.');if(_0x4b7f4e!=="58mm"&&_0x4b7f4e!=="80mm")throw new Error('Invalid paper size. Only "58mm" and "80mm" are supported.');this.paperSize=_0x4b7f4e;}setPaperSize(_0x4b7f4e){this.paperSize=_0x4b7f4e;}async checkBluetooth(){return navigator.bluetooth.getAvailability();}async _0x7r8s9t(_0x4b7f4e){_0x4b7f4e&&(await _0x4b7f4e.writeValue(this._0x9j0k1l.buffer),await _0x4b7f4e.writeValue(this._0x5p6q7r.buffer),await _0x4b7f4e.writeValue(this._0x1l2m3n.buffer),await _0x4b7f4e.writeValue(this._0x3n4o5p.buffer));}async writeLineBreak({_0x4b7f4e=1}={}){if(this._0x6q7r8s)for(let _0x5c6d7e=0;_0x5c6d7e<_0x4b7f4e;_0x5c6d7e++)await this._0x6q7r8s.writeValue(new Uint8Array([10]).buffer);}async writeDashLine(){this._0x6q7r8s&&(await this._0x6q7r8s.writeValue(this._0x6e7f8g.encode("-".repeat(this.paperSize==="58mm"?32:42))),await this.writeLineBreak());}async writeTextWith2Column(_0x4b7f4e,_0x5c6d7e,{bold:_0x6e7f8g=false,underline:_0x7g8h9i=false,align:_0x8i9j0k="left",size:_0x9j0k1l="normal"}={}){if(this._0x6q7r8s){if(_0x6e7f8g){await this._0x6q7r8s.writeValue(this._0x0k1l2m.buffer);}if(_0x7g8h9i){await this._0x6q7r8s.writeValue(this._0x2m3n4o.buffer);}if(_0x8i9j0k==="center"){await this._0x6q7r8s.writeValue(this._0x7g8h9i.buffer);}else if(_0x8i9j0k==="right"){await this._0x6q7r8s.writeValue(this._0x8i9j0k.buffer);}if(_0x9j0k1l==="double"){await this._0x6q7r8s.writeValue(this._0x4o5p6q.buffer);}await this._0x6q7r8s.writeValue(this._0x6e7f8g.encode(this.createItemData(_0x4b7f4e,_0x5c6d7e)));await this._0x7r8s9t(this._0x6q7r8s);await this.writeLineBreak();}}async writeText(_0x4b7f4e,{bold:_0x5c6d7e=false,underline:_0x6e7f8g=false,align:_0x7g8h9i="left",size:_0x8i9j0k="normal"}={}){if(this._0x6q7r8s){if(_0x5c6d7e){await this._0x6q7r8s.writeValue(this._0x0k1l2m.buffer);}if(_0x6e7f8g){await this._0x6q7r8s.writeValue(this._0x2m3n4o.buffer);}if(_0x7g8h9i==="center"){await this._0x6q7r8s.writeValue(this._0x7g8h9i.buffer);}else if(_0x7g8h9i==="right"){await this._0x6q7r8s.writeValue(this._0x8i9j0k.buffer);}else{await this._0x6q7r8s.writeValue(this._0x9j0k1l.buffer);}if(_0x8i9j0k==="double"){await this._0x6q7r8s.writeValue(this._0x4o5p6q.buffer);}await this._0x6q7r8s.writeValue(this._0x6e7f8g.encode(_0x4b7f4e));await this._0x7r8s9t(this._0x6q7r8s);await this.writeLineBreak();}}async connectToPrint({onReady:_0x4b7f4e,onFailed:_0x5c6d7e}){try{if(this.printerType==="usb"){const _0x6e7f8g=await navigator.usb.requestDevice({filters:[]});await _0x6e7f8g.open();await _0x6e7f8g.selectConfiguration(1);await _0x6e7f8g.claimInterface(0);await _0x6e7f8g.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:0});this._0x6q7r8s=_0x6e7f8g;if(this._0x6q7r8s){_0x4b7f4e(this);}else{_0x5c6d7e("No writable characteristic found.");}}else if(this.printerType==="bluetooth"){if(await this.checkBluetooth()){if(this._0x6q7r8s==null){navigator.bluetooth.requestDevice({filters:[{acceptAllDevices:true,services:["000018f0-0000-1000-8000-00805f9b34fb"]}]}).then(_0x4b7f4e=>{document.getElementById("status").textContent="Got device: "+_0x4b7f4e.name;return _0x4b7f4e.gatt.connect();}).then(_0x4b7f4e=>{document.getElementById("status").textContent+="\nConnected to GATT Server";return _0x4b7f4e.getPrimaryService("000018f0-0000-1000-8000-00805f9b34fb");}).then(_0x4b7f4e=>{return _0x4b7f4e.getCharacteristics();}).then(_0x4b7f4e=>{document.getElementById("status").textContent+="\nGot characteristics";let _0x5c6d7e=null;_0x4b7f4e.forEach(_0x4b7f4e=>{console.log("Characteristic UUID: "+_0x4b7f4e.uuid);if(_0x4b7f4e.properties.write){_0x5c6d7e=_0x4b7f4e;this._0x6q7r8s=_0x5c6d7e;}});if(_0x5c6d7e){_0x4b7f4e(this);}else{_0x5c6d7e("No writable characteristic found.");}}).catch(_0x4b7f4e=>{console.error(_0x4b7f4e);document.getElementById("status").textContent="Error: "+_0x4b7f4e;_0x5c6d7e(_0x4b7f4e.message);});}else{_0x4b7f4e(this);}}else{_0x5c6d7e("Perangkat Anda tidak mendukung untuk melakukan print dengan Bluetooth");}}else{_0x5c6d7e("Printer type not supported.");}}catch(_0x4b7f4e){_0x5c6d7e(_0x4b7f4e.message);}}createItemData(_0x4b7f4e,_0x5c6d7e){const _0x6e7f8g=(this.paperSize=="58mm"?32:40)-_0x4b7f4e.length-_0x5c6d7e.length;return _0x4b7f4e+" ".repeat(_0x6e7f8g)+_0x5c6d7e;}}